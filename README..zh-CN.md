# Unity-ROV2-Flow-field

## 简介

本项目基于 Unity 6000.0.49f1 开发，结合了流场寻路（FlowField Pathfinding）、动态避障、动态障碍管理与多目标控制，适用于塔防类或大规模单位移动的场景。项目中使用了以下技术与框架：

- **Unity 6000.0.49f1**
- **Zenject** 场景依赖注入
- **Flow Field Pathfinding** 实现高效多单位寻路
- **RVO2 库 (经过修改版)** 实现动态避障与单位间避让

本系统支持大规模单位流畅移动、动态添加障碍、复杂地图导航，并提供了丰富的调试与可视化功能，便于开发与调优。

---

## 功能模块

### Grid 系统
- 动态网格划分与坐标转换，支持浮点精度与中心对齐。
- 可调整地图尺寸、格子大小，适应不同关卡。

### Flow Field 系统
- BFS 搜索构建全图代价场，所有单位共享路径信息。
- 异步构建与局部刷新优化性能。

### 单位移动控制
- 基于流场方向实时推进移动，支持单位大小差异化方向融合：
  - 小单位：直接读取方向
  - 中单位：双线性插值（开发中）
  - 大单位：多格加权融合（开发中）
- 平滑移动、动态速度调整与缓动转向。（调试中）

### 动态障碍管理
- 支持运行时障碍添加/移除。
- 局部流场重建，避免全图重算。
- 精准障碍映射与调试可视化支持。

### 多目标寻路支持
- 支持多个目标点注册与流场缓存。
- 单位根据类型与逻辑动态选择目标流场。
- 目标切换无需全图重建流场。

---

## 避障模块修改说明（基于 RVO2）

本项目中的避障逻辑基于 [RVO2-CS (https://github.com/snape/RVO2-CS)] 项目，并做出以下改动以适配 Unity 环境与项目需求：

- 集成 Unity JobSystem 以提升性能
- 支持运行时动态添加/移除代理与障碍
- API 接口部分调整与简化
- 支持多模拟器实例并行运行
- 新增多个范例示例，便于理解与应用

由于原库采用 Apache 2.0 许可，修改部分已在本项目中开放公布，遵循原始许可协议。

---

## 许可协议

本项目代码遵循 MIT License。

避障部分源自 [RVO2-CS](https://github.com/snape/RVO2-CS) 并遵循其 Apache 2.0 许可。


